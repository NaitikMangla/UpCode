<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Code Editor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.41.0/min/vs/loader.min.js"></script>
    <style>
        #editor {
            width: 100%;
            height: 300px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <form action="http://localhost:3000/playground/submit" method="post">
        <label for="lang">Language:</label>
        <select id="lang" name="lang">
            <option value="10">C++</option>
            <option value="48">C</option>
            <option value="62">Java</option>
            <option value="71">Python</option>
            <option value="63">JavaScript</option>
        </select><br><br>

        <div id="editor"></div>
        <textarea id="srccode" name="srccode" hidden></textarea><br>

        <label for="stdin">Standard Input:</label>
        <textarea id="stdin" name="stdin" rows="5" cols="30"></textarea><br>

        <input type="submit" value="Submit">
    </form>

    <script>
        let editor;
        
        // Define default code snippets
        const defaultCode = {
            "10": `#include <iostream>\nusing namespace std;\n\nint main() {\n    //Write your code here!\n    return 0;\n}`,
            "48": `#include <stdio.h>\n\nint main() {\n    //Write your code here!\n    return 0;\n}`,
            "62": `class Main {\n    public static void main(String[] args) {\n        //Write your code here!\n    }\n}`,
            "71": `#Write your code here!`,
            "63": `//Write your code here!`
        };

        // Language mapping for Monaco Editor
        const langMap = {
            "10": "cpp",
            "48": "c",
            "62": "java",
            "71": "python",
            "63": "javascript"
        };

        require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.41.0/min/vs' } });
        require(['vs/editor/editor.main'], function () {
            editor = monaco.editor.create(document.getElementById('editor'), {
                value: defaultCode["10"], // Default to JavaScript
                language: "cpp",
                theme: "vs-dark"
            });
        });

        document.getElementById("lang").addEventListener("change", function () {
            let selectedLang = this.value;
            let monacoLang = langMap[selectedLang] || "javascript";
            
            // Update the editor's language
            monaco.editor.setModelLanguage(editor.getModel(), monacoLang);
            
            // Update the editor's content with the default code
            editor.setValue(defaultCode[selectedLang] || "// Write your code here...");
        });

        document.querySelector("form").addEventListener("submit", function () {
            document.getElementById("srccode").value = editor.getValue();
        });
    </script>
</body>
</html>
